@using Aciktim.Models
@model dynamic
@addTagHelper*, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = "_Layout";
    GetAddress address = Model.Address[0];
}
<div class="col-sm col-xl pt-4 px-4">
    <div class="bg-secondary rounded h-100 p-4">
        <form action="/Carrier/Address/Update" method="post" role="form">
            <div class="form-floating mb-3">
                <label for="country">Ülke</label>
            </div>
            <div class="form-floating mb-3">
                <select class="form-select form-select-sm mb-3" id="country" asp-items="@(new SelectList(@Model.Country,"CountryId","Name",address.Country))" aria-label="Floating label select example" name="CountryId">
                </select>
                <label for="country">Ülke</label>
            </div>
            <div class="form-floating mb-3">
                <select class="form-select form-select-sm mb-3" id="city" asp-items="@(new SelectList(string.Empty,"CityId","Name"))" aria-label="Floating label select example" name="CityId">
                </select>
                <label for="city">Şehir</label>
            </div>
            <div class="form-floating mb-3">
                <select class="form-select form-select-sm mb-3" id="state" asp-items="@(new SelectList(string.Empty,"StateId","Name"))" aria-label="Floating label select example" name="StateId">
                </select>
                <label for="state">İlçe</label>
            </div>
            <div class="form-floating mb-3">
                <select class="form-select form-select-sm mb-3" id="neighbourhood" asp-items="@(new SelectList(string.Empty,"NeighbourhoodId","Name"))" aria-label="Floating label select example" name="NeighbourhoodId">
                </select>
                <label for="neighbourhood">Mahalle</label>
            </div>
            <div class="form-floating mb-3">
                <select class="form-select form-select-sm mb-3" id="street" asp-items="@(new SelectList(string.Empty,"StreetId","Name"))" aria-label="Floating label select example" name="StreetId">
                </select>
                <label for="street">Sokak</label>
            </div>
            <div class="form-floating mb-3">
                <select class="form-select form-select-sm mb-3" id="apartment" asp-items="@(new SelectList(string.Empty,"ApartmentId","Name"))" aria-label="Floating label select example" name="ApartmentId">
                </select>
                <label for="apartment">Apartman</label>
            </div>
            <div class="form-floating mb-3">
                <select class="form-select form-select-sm mb-3" id="apartmentno" asp-items="@(new SelectList(string.Empty,"ApartmentNumberId","Name"))" aria-label="Floating label select example" name="ApartmentNumberId">
                </select>
                <label for="apartmentno">Daire</label>
            </div>

            <button type="submit" class="btn btn-sm btn-outline-success">Ekle</button>
        </form>

    </div>
</div>
@section scripts{

    <script src="~/Content/assets/js/required/jquery-1.11.1.min.js"></script>

    <script>
        //Cities
        $(document).ready(function() {
            $("#country").change(function() {
                var url = '@Url.Content("~/")' + "Carrier/Address/GetCities";
                var ddlsource = "#country";
                $.getJSON(url, { id: $(ddlsource).val() }, function(data) {
                    var items = "";
                    $("#city").empty();
                    $.each(data, function(i, city) {
                        items += "<option value='" + city.value + "'>" + city.text + "</option>";
                    });
                    $("#city").html(items);
                });
            });
        });
        //States
        $(document).ready(function() {
            $("#city").change(function() {
                var url = '@Url.Content("~/")' + "Carrier/Address/GetStates";
                var ddlsource = "#city";
                $.getJSON(url, { id: $(ddlsource).val() }, function(data) {
                    var items = "";
                    $("#state").empty();
                    $.each(data, function(i, state) {
                        items += "<option value='" + state.value + "'>" + state.text + "</option>";
                    });
                    $("#state").html(items);
                });
            });
        });
        //Neighbourhoods
        $(document).ready(function() {
            $("#state").change(function() {
                var url = '@Url.Content("~/")' + "Carrier/Address/GetNeighbourhoods";
                var ddlsource = "#state";
                $.getJSON(url, { id: $(ddlsource).val() }, function(data) {
                    var items = "";
                    $("#neighbourhood").empty();
                    $.each(data, function(i, neighbourhood) {
                        items += "<option value='" + neighbourhood.value + "'>" + neighbourhood.text + "</option>";
                    });
                    $("#neighbourhood").html(items);
                });
            });
        });
        //Streets
        $(document).ready(function() {
            $("#neighbourhood").change(function() {
                var url = '@Url.Content("~/")' + "Carrier/Address/GetStreets";
                var ddlsource = "#neighbourhood";
                $.getJSON(url, { id: $(ddlsource).val() }, function(data) {
                    var items = "";
                    $("#street").empty();
                    $.each(data, function(i, street) {
                        items += "<option value='" + street.value + "'>" + street.text + "</option>";
                    });
                    $("#street").html(items);
                });
            });
        });
        //Apartments
        $(document).ready(function() {
            $("#street").change(function() {
                var url = '@Url.Content("~/")' + "Carrier/Address/GetApartments";
                var ddlsource = "#street";
                $.getJSON(url, { id: $(ddlsource).val() }, function(data) {
                    var items = "";
                    $("#apartment").empty();
                    $.each(data, function(i, apartment) {
                        items += "<option value='" + apartment.value + "'>" + apartment.text + "</option>";
                    });
                    $("#apartment").html(items);
                });
            });
        });
        //Apartment Numbers
        $(document).ready(function() {
            $("#apartment").change(function() {
                var url = '@Url.Content("~/")' + "Carrier/Address/GetApartmentNumbers";
                var ddlsource = "#apartment";
                $.getJSON(url, { id: $(ddlsource).val() }, function(data) {
                    var items = "";
                    $("#apartmentno").empty();
                    $.each(data, function(i, apartmentno) {
                        items += "<option value='" + apartmentno.value + "'>" + apartmentno.text + "</option>";
                    });
                    $("#apartmentno").html(items);
                });
            });
        });
    </script>
}